{{template "base.html" .}}

{{define "edit-property"}}
<div class="page-header">
    <h1 class="page-title">Edit Property</h1>
    <a href="/show-property/{{.Property.ID}}" class="btn btn-secondary">← Back to Property</a>
</div>

<div class="card">
    <form method="POST" action="/update-property/{{.Property.ID}}">
        <h2>Basic Information</h2>

        <div class="form-group">
            <label for="name">Property Name *</label>
            <input type="text" id="name" name="name" value="{{.Property.Name}}" required>
        </div>

        <div class="form-group">
            <label for="description">Description</label>
            <textarea id="description" name="description" rows="4">{{.Property.Description}}</textarea>
        </div>

        <div class="form-group">
            <label for="status">Status *</label>
            <select id="status" name="status" required>
                <option value="available" {{if eq .Property.Status "available"}}selected{{end}}>Available</option>
                <option value="sold" {{if eq .Property.Status "sold"}}selected{{end}}>Sold</option>
                <option value="rented" {{if eq .Property.Status "rented"}}selected{{end}}>Rented</option>
                <option value="reserved" {{if eq .Property.Status "reserved"}}selected{{end}}>Reserved</option>
                <option value="draft" {{if eq .Property.Status "draft"}}selected{{end}}>Draft</option>
            </select>
        </div>

        <h2 style="margin-top: 2rem;">Classification</h2>

        <div class="form-group">
            <label for="category_id">Category *</label>
            <select id="category_id" name="category_id" required>
                <option value="">-- Select Category --</option>
                {{range .Categories}}
                <option value="{{.id}}" {{if eq .id (printf "%s" $.Property.Classification.CategoryID)}}selected{{end}}>{{.name}}</option>
                {{end}}
            </select>
        </div>

        <div class="form-group">
            <label for="type_id">Type *</label>
            <select id="type_id" name="type_id" required>
                <option value="">-- Select Type --</option>
                {{range .Types}}
                <option value="{{.id}}" {{if eq .id (printf "%s" $.Property.Classification.TypeID)}}selected{{end}}>{{.name}}</option>
                {{end}}
            </select>
        </div>

        <div class="form-group">
            <label for="subtype_id">Subtype</label>
            <select id="subtype_id" name="subtype_id">
                <option value="">-- Select Subtype (Optional) --</option>
                {{range .Subtypes}}
                <option value="{{.id}}" {{if eq .id (printf "%s" $.Property.Classification.SubtypeID)}}selected{{end}}>{{.name}}</option>
                {{end}}
            </select>
        </div>

        <h2 style="margin-top: 2rem;">Location</h2>

        <div class="form-group">
            <label for="street">Street *</label>
            <input type="text" id="street" name="street" value="{{.Property.Location.Address.Street}}" required>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
            <div class="form-group">
                <label for="number">Number</label>
                <input type="text" id="number" name="number" value="{{.Property.Location.Address.Number}}">
            </div>

            <div class="form-group">
                <label for="unit">Unit</label>
                <input type="text" id="unit" name="unit" value="{{.Property.Location.Address.Unit}}">
            </div>
        </div>

        <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 1rem;">
            <div class="form-group">
                <label for="city">City *</label>
                <input type="text" id="city" name="city" value="{{.Property.Location.Address.City}}" required>
            </div>

            <div class="form-group">
                <label for="state">State</label>
                <input type="text" id="state" name="state" value="{{.Property.Location.Address.State}}">
            </div>

            <div class="form-group">
                <label for="postal_code">Postal Code</label>
                <input type="text" id="postal_code" name="postal_code" value="{{.Property.Location.Address.PostalCode}}">
            </div>
        </div>

        <div class="form-group">
            <label for="country">Country *</label>
            <input type="text" id="country" name="country" value="{{.Property.Location.Address.Country}}" required>
        </div>

        <div class="form-group">
            <label for="region">Region</label>
            <input type="text" id="region" name="region" value="{{.Property.Location.Region}}">
        </div>

        <h2 style="margin-top: 2rem;">Features</h2>

        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem;">
            <div class="form-group">
                <label for="total_area">Total Area (m²) *</label>
                <input type="number" id="total_area" name="total_area" step="0.01" value="{{.Property.Features.TotalArea}}" required>
            </div>

            <div class="form-group">
                <label for="bedrooms">Bedrooms *</label>
                <input type="number" id="bedrooms" name="bedrooms" min="0" value="{{.Property.Features.Bedrooms}}" required>
            </div>

            <div class="form-group">
                <label for="bathrooms">Bathrooms *</label>
                <input type="number" id="bathrooms" name="bathrooms" min="0" value="{{.Property.Features.Bathrooms}}" required>
            </div>

            <div class="form-group">
                <label for="parking">Parking Spaces</label>
                <input type="number" id="parking" name="parking" min="0" value="{{.Property.Features.Parking}}">
            </div>
        </div>

        <h2 style="margin-top: 2rem;">Price</h2>

        <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 1rem;">
            <div class="form-group">
                <label for="price_amount">Amount *</label>
                <input type="number" id="price_amount" name="price_amount" step="0.01" value="{{.Property.Price.Amount}}" required>
            </div>

            <div class="form-group">
                <label for="currency">Currency *</label>
                <select id="currency" name="currency" required>
                    <option value="EUR" {{if eq .Property.Price.Currency "EUR"}}selected{{end}}>EUR</option>
                    <option value="USD" {{if eq .Property.Price.Currency "USD"}}selected{{end}}>USD</option>
                    <option value="PLN" {{if eq .Property.Price.Currency "PLN"}}selected{{end}}>PLN</option>
                </select>
            </div>

            <div class="form-group">
                <label for="price_type">Type *</label>
                <select id="price_type" name="price_type" required>
                    <option value="sale" {{if eq .Property.Price.Type "sale"}}selected{{end}}>Sale</option>
                    <option value="rent_monthly" {{if eq .Property.Price.Type "rent_monthly"}}selected{{end}}>Rent (Monthly)</option>
                    <option value="rent_daily" {{if eq .Property.Price.Type "rent_daily"}}selected{{end}}>Rent (Daily)</option>
                </select>
            </div>
        </div>

        <div class="form-group">
            <label for="owner_id">Owner ID</label>
            <input type="text" id="owner_id" name="owner_id" value="{{.Property.OwnerID}}">
        </div>

        <div class="form-group" style="margin-top: 2rem;">
            <button type="submit" class="btn btn-primary">Update Property</button>
            <a href="/show-property/{{.Property.ID}}" class="btn btn-secondary" style="margin-left: 1rem;">Cancel</a>
        </div>
    </form>
</div>
{{end}}
